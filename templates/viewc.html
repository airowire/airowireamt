<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
{% if session['tname'] == 'project' or session['tname'] == 'noc' %}
{% extends 'sidebar.html' %}
{% block content %}
 
<div class="container-fluid">
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Chat Window</title>
        <!-- Bootstrap CSS -->
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
        <!-- Custom CSS -->
        <style>
            /* Adjust as needed */
            .chat-container {
                max-width: 500px;
                margin: auto;
                margin-top: 50px;
            }
            .chat-box {
                overflow-y: scroll;
                max-height: 300px;
            }
        </style>
    </head>
    <body>
    
    <div class="container">
        <div class="chat-container">
            <div class="card">
                <div class="card-header">
                    Chat Window
                </div>
                <div class="card-body chat-box" id="chat-box">
                    <!-- Chat messages will be displayed here -->
                    <div class="media mb-3">
                        <img src="{{ url_for('static', filename='img/itlogo.png') }}" class="mr-3 rounded-circle" alt="User" width="70">
                        <div class="media-body">
                            <br>
                            Hello, how can I help you?
                        </div>
                    </div>
</div>
{% for row in data %}
    {% if row[3] != '' %}
        <div class="media mb-3">
            <img src="https://i.pinimg.com/736x/64/81/22/6481225432795d8cdf48f0f85800cf66.jpg" class="mr-3 rounded-circle" alt="User" width="50">
            <div class="media-body">
                <br>
                <p>{{ row[3] }}</p>
            </div>
        </div>
    {% elif row[4] != '' %}
        <div class="media mb-3">
            <img src="{{ url_for('static', filename='img/itlogo.png') }}" class="mr-3 rounded-circle" alt="Admin" width="70">
            <div class="media-body">
                <br>
                <p>{{ row[4] }}</p>
            </div>
        </div>
    {% endif %}
{% endfor %}
 
                
                </div>
                <div class="card-footer">
                   
                        <form action="{{ url_for('viewc') }}" method="post">
                            <input type="hidden" name="id" value="{{ id }}" placeholder="{{ id }}">
                        <div class="row">
                            <div class="col-lg-6">
                                <input type="text" class="form-control" placeholder="Type your message" id="message-input" name="user_message">
                            </div>
                            <div class="col-lg-6">
                                <button class="btn btn-primary" type="submit" id="send-btn">Send</button>
                            </div>
                        </div>
                        </form>
                    
                </div>
            </div>
        </div>
    </div>


    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Custom JS (for sending messages) -->
   
    
    </body>
    </html>
    
</div>

{% endblock %}
       
{% else %}
<script>
 // Display a SweetAlert message and logout after 5 seconds
 window.onload = function() {
     Swal.fire({
         title: 'Access Denied!',
         text: 'You are not allowed to view this page.',
         icon: 'warning',
         timer: 5000, // Automatically close the alert after 5 seconds
         timerProgressBar: true,
         showConfirmButton: false
     }).then((result) => {
         // Redirect to logout page after the alert is closed
         if (result.dismiss === Swal.DismissReason.timer) {
             window.location.href = "/logout";
         }
     });
 };
</script>
{% endif %}
